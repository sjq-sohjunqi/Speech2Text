{% extends "base.html" %}
{% block content %}
        <script src="https://cdnjs.cloudflare.com/ajax/libs/zxcvbn/4.2.0/zxcvbn.js"></script>
        <script type="text/javascript">
            var password = document.getElementById('password');
            var meter = document.getElementById('password-strength-meter');
            var text = document.getElementById('password-strength-text');

             function validatePassword(password) {

                // Do not show anything when the length of password is zero.
                if (password.length === 0) {
                    document.getElementById("msg").innerHTML = "";
                    return;
                }
                // Create an array and push all possible values that you want in password
                var matchedCase = new Array();
                matchedCase.push("[$@$!%*#?&]"); // Special Charector
                matchedCase.push("[A-Z]");      // Uppercase Alpabates
                matchedCase.push("[0-9]");      // Numbers
                matchedCase.push("[a-z]");     // Lowercase Alphabates

                // Check the conditions
                var ctr = 0;
                for (var i = 0; i < matchedCase.length; i++) {
                    if (new RegExp(matchedCase[i]).test(password)) {
                        ctr++;
                    }
                }
                // Display it
                var color = "";
                var strength = "";
                var mete=0;
                switch (ctr) {
                    case 0:
                        mete=0;
                    case 1:
                        mete=1;
                    case 2:
                        mete=2;
                        strength = "Very Weak";
                        color = "red";
                        break;
                    case 3:
                        mete=3;
                        strength = "Medium";
                        color = "orange";
                        break;
                    case 4:
                        mete=4;
                        strength = "Strong";
                        color = "green";
                        break;
                }
                document.getElementById('password-strength-text').innerHTML = strength;
                document.getElementById('password-strength-text').style.color = color;
                document.getElementById('password-strength-meter').value = mete;
            }
        </script>
		<form action="" method="post" novalidate>
        <div class="row">
        <div class='col-md-5'>
			{{ form.hidden_tag() }} <!Protects against CSRF>
			 <fieldset class="form-group">
                <legend class="border-bottom mb-4">Sign Up</legend>

                <div class="form-group">
                    {{ form.username.label(class="form-control-label") }}
                    {% if form.username.errors %}
                        {{ form.username(class="form-control form-control-lg is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.username.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.username(class="form-control form-control-lg") }}
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.name.label(class="form-control-label") }}
                    {% if form.name.errors %}
                        {{ form.name(class="form-control form-control-lg is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.name.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.name(class="form-control form-control-lg") }}
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.password.label(class="form-control-label") }}
                    {% if form.password.errors %}
                        {{ form.password(class="form-control form-control-lg is-invalid") }}
                        <div class="invalid-feedback">
                            {% for error in form.password.errors %}
                                <span>{{ error }}</span>
                            {% endfor %}
                        </div>
                    {% else %}
                        {{ form.password(class="form-control form-control-lg",onkeyup="validatePassword(this.value);") }}
                    {% endif %}
                </div>
                <meter max="4" low="1" high="3" optimum="4" id="password-strength-meter" style="width: 100%; height: 20px;"></meter>
                <p id="password-strength-text"></p>

				<div class="form-group">
				{{ form.confirm_password.label(class="form-control-label") }}
				{% if form.confirm_password.errors %}
					{{ form.confirm_password(class="form-control form-control-lg is-invalid") }}
					<div class="invalid-feedback">
						{% for error in form.confirm_password.errors %}
							<span>{{ error }}</span>
						{% endfor %}
					</div>
				{% else %}
					{{ form.confirm_password(class="form-control form-control-lg") }}
				{% endif %}
				</div>

                <br>
            </fieldset>
            <small class="text-muted ml-2">
                <a href="{{ url_for('login') }}">Already have an account?</a>
            </small>
            </div>
            </div>
            <div class="row">
            <div class="col-md-4"></div>
            <div class="col-md-1 form-group">
                <div class="loginButton">
                {{ form.submit(class="btn btn-outline-info") }}
                </div>
            </div>
            </div>

		</form>
{% endblock %}

